package entidades;

import java.util.ArrayList;
import java.util.InputMismatchException;
import java.util.Scanner;

import aplicacao.MenuUser;
import reserva.Estoque;
import reserva.StatusProduto;
import utilidade.ValidarDados;

public abstract class Utilizador<T> {

	static Scanner sc = new Scanner(System.in);

	protected abstract void pagamento();

	public abstract void cadastro();

	public abstract void listarDividas();

	public static void rastrearProdutos() {
		// definir como null pra conseguirmos retornar um par√¢metro
		DadosProduto resultado = null;
		Integer idRastreio;
		boolean listagem = true;
		while (listagem) {
			try {
				System.out.println("Digite o ID de rastreio do produto: ");
				System.out.print("\n->");
				idRastreio = sc.nextInt();
				resultado = Estoque.buscarIDBinarySearch(idRastreio);
				if (!ValidarDados.validarIdProduto(idRastreio)) {
					throw new IllegalArgumentException("Erro, s√£o necess√°rios 6 d√≠gitos para o ID");
				}
				if (resultado == null) {
					System.out.println("Produto: " + StatusProduto.INEXISTENTE);
				} else {
					ArrayList<DadosProduto> listaUnica = new ArrayList<>();
					listaUnica.add(resultado);
					// fazer print metodo static de utilidades.
					printarProdutos(listaUnica);
				}
				listagem = false;
			} catch (IllegalArgumentException e) {
				System.err.printf("Entrada inv√°lida, %s, digite enter para tentar novamente.\n", e.getMessage());
				sc.nextLine();
			} catch (InputMismatchException e) {
				System.err.printf("Entrada inv√°lida, %s, digite enter para tentar novamente.\n", e.getMessage());
				sc.nextLine();
			}
			System.out.println("Pressione enter para voltar");
			sc.nextLine();
			sc.nextLine();
		}
	}

	// passo a determinada lista para printar todos os produtos associados. tanto
	// cliente, quanto fornecedor
	public static void printarProdutos(ArrayList<DadosProduto> listaTodosProdutos) {
		System.out.println("Total de registros: " + listaTodosProdutos.size());
		System.out.println();
		System.out.println("üü° indica que √© preciso realizar a√ß√£o para que o objeto seja encaminhado ao seu destino.");
		System.out.println("üî¥ simboliza que o produto ser√° retornado por expirar");
		System.out.println("‚ö´ mostra que o produto foi negado na alf√¢ndega e foi encaminhado para as autoridades.\n");
		System.out.printf("%s", "aviso", "id", "cpf vinculado", "situa√ß√£o atual", "data da situa√ß√£o");
		// recebendo uma lista j√° filtrada de todos produtos do cliente.
		for (DadosProduto dadoProduto : listaTodosProdutos) {
			// se n√£o estiver no estoque, estar√° no despache
			System.out.println(dadoProduto);
		}
	}

	public void avisosCanal(ArrayList<DadosProduto> produtosListados) {
		// contador para o total de produtos
		long contador = 0;
		for (DadosProduto produto : produtosListados) {
			if (!(produto.getRecado().equals(null))) {
				System.out.printf("O produto: %s est√° %s - %s", produto.getTipoProduto(), produto.getStatus(),
						produto.getRecado());
				contador++;
			}
		}
		System.out.println("Total de avisos: " + contador);
		System.out.println();
		if (contador == 0) {
			System.out.println("Voc√™ n√£o possui avisos de urg√™ncia estendidos do produto.");
		}
		// Se o produto tiver no estoque e com a colo√ß√£o amarela, verificar com o
		// funcionario, mensagem;
	}

	public static void identificarCadastro(MenuUser status) {
		boolean opCadastro = true;
		while (opCadastro) {
			try {
				System.out.println("Cadastrar:");
				System.out.print("Seu nome: ");
				String nome = sc.nextLine();
				System.out.print("Seu e-mail: ");
				String email = sc.next();
				if (!ValidarDados.validarEmail(email))
					System.out.print("Sua senha: ");
				String senha = sc.next();

				if (status.equals(MenuUser.CLIENTE)) {
					System.out.print("Seu cpf: ");
					String cpf = sc.next().replace(".", "").replace("-", "");
					if (!ValidarDados.validarCPF(cpf)) {
						throw new IllegalArgumentException("CPF inv√°lido");
					}
					// testar sem - e .
					Cliente pessoa = new Cliente(nome, email, senha, cpf);
					pessoa.cadastro();
				} else if (status.equals(MenuUser.FORNECEDOR)) {
					Fornecedor pessoa = new Fornecedor(nome, email, senha);
					pessoa.cadastro();
				} else if (status.equals(MenuUser.FUNCIONARIO)) {
					System.out.println("Um usu√°rio s√≥ pode ser cadastrado por outro funcion√°rio.");
				} else {
					System.out.println("Operador n√£o encontrado");
				}
				opCadastro = false;
			} catch (IllegalArgumentException e) {
				System.out.printf("Erro, argumento inv√°lido, %s, reiniciando o cadastro.\n" + e.getMessage());
			}
		}
	}

}
